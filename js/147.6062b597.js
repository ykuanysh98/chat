"use strict";(self["webpackChunkmy_vue3_project"]=self["webpackChunkmy_vue3_project"]||[]).push([[147],{4147:function(e,s,r){r.r(s),r.d(s,{default:function(){return V}});var t=r(6768);function n(e,s,r,n,a,u){const o=(0,t.g2)("UserSelection"),c=(0,t.g2)("ChatWindow");return(0,t.uX)(),(0,t.CE)("div",null,[n.currentUser?((0,t.uX)(),(0,t.Wv)(c,{key:1})):((0,t.uX)(),(0,t.Wv)(o,{key:0}))])}var a=r(144),u=r(4232);const o={key:0,class:"title"},c={key:1,class:"user-current"},l={class:"user-sidebar"},i=["onClick"];function d(e,s,r,n,a,d){const g=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("div",{class:(0,u.C4)(["user-selection",{"user-selection--chat":r.isCurrentUser}])},[r.isCurrentUser?((0,t.uX)(),(0,t.CE)("div",c,(0,u.v_)(n.currentUser.slice(0,1)),1)):((0,t.uX)(),(0,t.CE)("h2",o,"Выберите пользователя")),(0,t.Lk)("div",l,[(0,t.Lk)("ul",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.filteredUsers,(e=>((0,t.uX)(),(0,t.CE)("li",{key:e,onClick:s=>n.selectUser(e),class:(0,u.C4)({"selected-user":e===n.currentChat})},(0,u.v_)(e),11,i)))),128))]),r.isCurrentUser?((0,t.uX)(),(0,t.CE)("button",{key:0,class:"logout",onClick:s[0]||(s[0]=(...e)=>n.clearCurrent&&n.clearCurrent(...e))}," Выйти ")):(0,t.Q3)("",!0)]),r.isCurrentUser?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.Wv)(g,{key:2,to:"/settings",class:"settings-link"},{default:(0,t.k6)((()=>s[1]||(s[1]=[(0,t.eW)(" Настройки ")]))),_:1}))],2)}r(8992),r(4520);var g={props:{isCurrentUser:Boolean},setup(e){const s=(0,a.KR)(JSON.parse(localStorage.getItem("users"))||["User1","User2","User3","User4"]),r=(0,a.KR)(sessionStorage.getItem("currentUser")),n=(0,a.KR)(sessionStorage.getItem("currentChat")),u=(0,t.EW)((()=>s.value.filter((e=>e!==r.value)))),o=s=>{e.isCurrentUser?(sessionStorage.setItem("currentChat",s),n.value=s):sessionStorage.setItem("currentUser",s),window.location.reload()},c=()=>{sessionStorage.removeItem("currentUser"),sessionStorage.removeItem("currentChat"),window.location.reload()};return{users:s,filteredUsers:u,selectUser:o,currentUser:r,currentChat:n,clearCurrent:c}}},v=r(1241);const C=(0,v.A)(g,[["render",d],["__scopeId","data-v-04efa882"]]);var m=C;const U={class:"chat-window"},p={key:1};function k(e,s,r,n,a,u){const o=(0,t.g2)("UserSelection"),c=(0,t.g2)("MessageWindow");return(0,t.uX)(),(0,t.CE)("div",U,[(0,t.bF)(o,{isCurrentUser:""}),n.currentChat?((0,t.uX)(),(0,t.Wv)(c,{key:0})):((0,t.uX)(),(0,t.CE)("h1",p,"Выберите Чат"))])}const S={class:"message-window"};function h(e,s,r,n,a,u){const o=(0,t.g2)("MessageList"),c=(0,t.g2)("MessageInput");return(0,t.uX)(),(0,t.CE)("div",S,[(0,t.bF)(o,{messages:n.filteredMessages,currentUser:n.currentUser},null,8,["messages","currentUser"]),(0,t.bF)(c,{onSendMessage:n.addMessage},null,8,["onSendMessage"])])}r(4114);const I={class:"message-list"},f={key:1};function w(e,s,r,n,a,o){return(0,t.uX)(),(0,t.CE)("div",I,[r.messages.length?((0,t.uX)(!0),(0,t.CE)(t.FK,{key:0},(0,t.pI)(r.messages,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:(0,u.C4)({sent:e.sender===r.currentUser,received:e.receiver===r.currentUser})},[(0,t.Lk)("p",null,[(0,t.Lk)("strong",null,(0,u.v_)(e.sender),1),(0,t.eW)(": "+(0,u.v_)(e.text),1)])],2)))),128)):((0,t.uX)(),(0,t.CE)("h1",f,"Нет чата"))])}var X={props:["messages","currentUser"]};const E=(0,v.A)(X,[["render",w],["__scopeId","data-v-02c0c402"]]);var y=E,M=r(5130);const _={class:"message-input"};function W(e,s,r,n,a,u){return(0,t.uX)(),(0,t.CE)("div",_,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.text=e),type:"text",placeholder:"Напишите свое сообщение...",onKeyup:s[1]||(s[1]=(0,M.jR)(((...e)=>n.send&&n.send(...e)),["enter"]))},null,544),[[M.Jo,n.text]]),(0,t.Lk)("button",{onClick:s[2]||(s[2]=(...e)=>n.send&&n.send(...e))},"Отправлять")])}var K={emits:["sendMessage"],setup(e,{emit:s}){const r=(0,a.KR)(""),t=()=>{if(!r.value.trim())return;const e={id:Date.now(),sender:sessionStorage.getItem("currentUser"),receiver:sessionStorage.getItem("currentChat"),text:r.value.trim(),timestamp:(new Date).toISOString()};s("sendMessage",e),r.value=""};return{text:r,send:t}}};const b=(0,v.A)(K,[["render",W]]);var L=b,R={components:{MessageList:y,MessageInput:L},setup(){const e=sessionStorage.getItem("currentUser"),s=sessionStorage.getItem("currentChat"),r=(0,a.KR)(JSON.parse(localStorage.getItem("messages"))||[]),n=(0,t.EW)((()=>r.value.filter((r=>r.sender===e&&r.receiver===s||r.sender===s&&r.receiver===e))));(0,t.sV)((()=>{window.addEventListener("storage",(()=>{r.value=JSON.parse(localStorage.getItem("messages"))||[]}))}));const u=e=>{r.value.push(e),localStorage.setItem("messages",JSON.stringify(r.value)),window.location.reload()};return{currentUser:e,currentChat:s,filteredMessages:n,allMessages:r,addMessage:u}}};const x=(0,v.A)(R,[["render",h]]);var A=x,F={components:{MessageWindow:A,UserSelection:m},setup(){const e=(0,a.KR)(null);return(0,t.sV)((()=>{e.value=sessionStorage.getItem("currentChat")})),{currentChat:e}}};const J=(0,v.A)(F,[["render",k],["__scopeId","data-v-71e7ffee"]]);var O=J,N={name:"HomePage",components:{UserSelection:m,ChatWindow:O},setup(){const e=(0,a.KR)(sessionStorage.getItem("currentUser"));return{currentUser:e}}};const j=(0,v.A)(N,[["render",n]]);var V=j}}]);
//# sourceMappingURL=147.6062b597.js.map